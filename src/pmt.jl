"""
The PMT model.

# Arguments
- `photocathode_area`: the total are of the photocathode including the reflector ring [m^2]
- `quantum_efficiency`: a callable which returns the quantum efficiency
  for a given wavelength [ns]
- `angular_acceptance`: a callable which returns the angular acceptance
  (for values between -1 and 1) for a given wavelength [ns]
"""
struct PMTModel{T1,T2}
    photocathode_area::Float64
    quantum_efficiency::T1
    angular_acceptance::T2
end

# Values taken from section 2.1.2 in https://simulation.pages.km3net.de/input_tables/Simulations_Description.pdf
const KM3NeTPMT = PMTModel(
    Ï€ * (4.7462)^2 * 1.0e-4, # photo-cathode area including the reflector ring [m^2]
    # The quantum efficiency includes absorption in glass and gel.
    LinearInterpolator(
        [
            300,
            310,
            320,
            330,
            340,
            350,
            360,
            370,
            380,
            390,
            400,
            410,
            420,
            430,
            440,
            450,
            460,
            470,
            480,
            490,
            500,
            510,
            520,
            530,
            540,
            550,
            560,
            570,
            580,
            590,
            600,
            610,
            620,
            630,
            640,
            650,
            660,
            670,
            680,
            690,
            700,
            710,
        ],

        # collection efficiency (was once with factor 0.9, now 1.0) correction
        0.01 *
        1.00 *
        [
            0.000,
            1.860,
            7.721,
            15.912,
            21.981,
            24.729,
            26.476,
            27.525,
            27.213,
            28.295,
            27.973,
            27.435,
            26.905,
            26.527,
            25.978,
            25.203,
            23.898,
            22.252,
            20.827,
            19.997,
            19.326,
            18.546,
            16.584,
            13.321,
            10.680,
            9.096,
            7.924,
            7.131,
            6.252,
            5.373,
            4.577,
            3.738,
            3.111,
            2.442,
            1.947,
            1.578,
            1.270,
            0.907,
            0.626,
            0.435,
            0.252,
            0.000,
        ],
        NoBoundaries(),
    ),

    # last value included to get exact zeros outside of the upper boundary defined in Jpp (i.e. >=0.25)
    LinearInterpolator(
        [
            -1.00,
            -0.95,
            -0.90,
            -0.85,
            -0.80,
            -0.75,
            -0.70,
            -0.65,
            -0.60,
            -0.55,
            -0.50,
            -0.45,
            -0.40,
            -0.35,
            -0.30,
            -0.25,
            -0.20,
            -0.15,
            -0.10,
            -0.05,
            0.00,
            0.05,
            0.10,
            0.15,
            0.20,
            0.25,
            1,
        ],
        [
            1.0000,
            0.8301,
            0.7357,
            0.6619,
            0.5998,
            0.5410,
            0.4874,
            0.4387,
            0.3947,
            0.3544,
            0.3190,
            0.2777,
            0.2445,
            0.2101,
            0.1818,
            0.1535,
            0.1276,
            0.1025,
            0.0788,
            0.0586,
            0.0400,
            0.0233,
            0.0104,
            0.0039,
            0.0017,
            0.0000,
            0.0000,
        ],
        NoBoundaries(),
    ),
)
